```{r setup, include=FALSE, echo=FALSE}
options(
  encoding = "UTF-8",
  knitr.kable.NA = "",
  knitr.kable.digits = 2,
  knitr.kable.format = "latex"
)

knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(result = "hold")

if(!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)

if(!require("scales")) install.packages("scales")
library(scales)

if(!require("kableExtra")) install.packages("kableExtra")
library(kableExtra)

```

```{r}
app.table.default <- function(data, align = NULL, caption = NULL, format.args = list(big.mark = ".", decimal.mark =",", nsmall = 2), col.names = NULL) {
  return(
    knitr::kable(data, align=align, caption = caption, format.args = format.args, col.names = col.names)
  )
}

app.plot.theming <- function(g) {
  return(
    g +
      theme(
        legend.position = "top",
        legend.justification = "left",
        legend.title = element_blank(),
        legend.background = element_blank(),
        legend.box.background = element_blank(),
        panel.background = element_rect(fill = "transparent"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        plot.background = element_rect(fill = "transparent")
        ) +
      xlab(NULL) +
      ylab(NULL)
  )
}

app.color.primary <- "black"
app.color.secondary <- "grey"
```

```{r}
ds_file <- "indicadores cm.xlsx"
df <- readxl::read_excel(ds_file, sheet = "Dados")
data_base <- as.Date(df$data_base[1])
periodo <- format(data_base, format = "%B de %Y")
ano_base <- format(data_base, format = "%Y")
```

---
title: "Indicadores Fiscais e Gerenciais da Câmara de Vereadores"
author: "Everton da Rosa"
date: "`r periodo`"
---

***

Este relatório tem o objetivo de apresentar os principais indicadores legais e gerenciais relativos à **Câmara de Vereadores** do Município de **Independência/RS**.

***

# Indicadores Legais

Esta seção apresenta os principais indicadores estabelecidos em legislação aos quais o Poder Legislativo precisa obedecer, ainda que o seu acompanhamento mensal atenda à função gerencial, possibilitando a tomada de providências quando houver indicação de possível desatendimento de algum dos limites impostos.

## Limite Constitucional de Gastos Totais

O Poder Legislativo possui um limite de gasto total anual, este expresso no art. 29-A da Constituição Federal.

> Art.  29-A.  O total da despesa do Poder Legislativo Municipal, incluídos os subsídios dos Vereadores e excluídos os gastos com inativos, não poderá ultrapassar os seguintes percentuais, relativos ao somatório da receita tributária e das transferências previstas no § 5o do art. 153 e nos arts. 158 e 159, efetivamente realizado no exercício anterior:

No caso do Legislativo de Independência, o *limite constitucional é de 7%* da *Receita Efetivamente Arrecadada no Exercício Anterior*.


```{r}
df <- readxl::read_excel(ds_file, sheet = "GastoTotal")
df$ano <- as.factor(format(df$data_base, format = "%Y"))
df$mes <- as.factor(format(df$data_base, format = "%b"))
df$data_base <- NULL
df <- select(df, ano, mes, vl_limite, vl_gasto_total_estimado, vl_resultado_estimado, indice_estimado)
df <- df[df$ano==ano_base,]
df$indice_estimado <- percent(df$indice_estimado)
df$ano <- NULL
```

```{r}
tbl = app.table.default(df, align=c("l", "r", "r", "r", "r"), caption = "Gasto Total Estimado", col.names = c("Mês", "Limite R$", "Gasto Total Estimado R$", "Resultado Estimado R$", "Índice Estimado %"))
tbl
```

É importante salientar que o indicador de gastos totais é apurado apenas no encerramento do exercício para fins de cumprimento ou não do limite constitucional, sendo que a sua estimativa mensal tem finalidade gerencial.


```{r}
df$mes <- as.factor(df$mes)
g <- ggplot(df, aes(x = mes, group = 1)) +
  ggtitle("Gasto Total (CF 1988)") +
  geom_bar(aes(y = vl_gasto_total_estimado, fill = "Gasto Total"), stat = "identity", position = "dodge", na.rm = TRUE) +
  geom_line(aes(y = vl_limite, color = "Limite"), na.rm = TRUE) +
  scale_y_continuous(labels = scales::number_format(big.mark = ".", decimal.mark = ",")) +
  scale_x_discrete(limits = df$mes) +
  scale_fill_manual(values = app.color.primary) + 
  scale_color_manual(values = app.color.secondary)
g <- app.plot.theming(g)
g
```

Até o presente mês, observa-se que a estimativa de gastos totais do Legislativo, baseada na dotação atualizada da Câmara de Vereadores está adequada ao limite constitucional.

## Limite Constitucional de Gasto com Folha de Pagamentos

A Constituição Federal, no § 1ºdo art. 29-A limita o gasto com folha de pagamento a *70% do limite de gasto total* do Poder Legislativo.

> Art. 29-A [...]
> 
> § 1º A Câmara Municipal não gastará mais de setenta por cento de sua receita com folha de pagamento, incluído o gasto com o subsídio de seus Vereadores.

Segundo as disposições do TCE/RS, além do grupo de natureza de despesa de Pessoal e Encargos Sociais, computam nesse limite as despesas relativas a auxílio-alimentação (independentemente do nome dado ao auxílio) quando não empenhadas naquele grupo de natureza de despesa.

```{r}
df <- readxl::read_excel(ds_file, sheet = "GastoFolha")
df$ano <- as.factor(format(df$data_base, format = "%Y"))
df$mes <- as.factor(format(df$data_base, format = "%b"))
df$data_base <- NULL
df <- select(df, ano, mes, vl_limite, vl_gasto_total_estimado, vl_resultado_estimado, indice_estimado)
df <- df[df$ano==ano_base,]
df$indice_estimado <- percent(df$indice_estimado)
df$ano <- NULL
```

```{r}
tbl = app.table.default(df, align=c("l", "r", "r", "r", "r"), caption = "Gasto com Folha de Pagamento", col.names = c("Mês", "Limite R$", "Gasto com Folha Estimado R$", "Resultado Estimado R$", "Índice Estimado %"))
tbl
```

A verificação do atendimento ou não a esse limite constitucional é feito apenas no encerramento do exercício, o que equivale dizer que o acompanhamento mensal desse indicador tem caráter gerencial.

```{r}
df$mes <- as.factor(df$mes)
g <- ggplot(df, aes(x = mes, group = 1)) +
  ggtitle("Gasto com Folha de Pagamento (CF 1988)") +
  geom_bar(aes(y = vl_gasto_total_estimado, fill = "Gasto com Folha"), stat = "identity", position = "dodge", na.rm = TRUE) +
  geom_line(aes(y = vl_limite, color = "Limite"), na.rm = TRUE) +
  scale_y_continuous(labels = scales::number_format(big.mark = ".", decimal.mark = ",")) +
  scale_x_discrete(limits = df$mes) +
  scale_fill_manual(values = app.color.primary) + 
  scale_color_manual(values = app.color.secondary)
g <- app.plot.theming(g)
g
```

Até a avaliação mais atual, vislumbra-se que o gasto com folha de pagamento do Legislativo possui clara tendência de estar adequado ao limite constitucional, caso as condições atuais relativas à gestão de pessoal desse Poder se mantenham dentro dos parâmetros atuais.

## Limite de Despesa Total com Pessoal da LRF

A Lei Complementar nº 101/2000 – Lei de Responsabilidade Fiscal/LRF – estabelece limites para a despesa total com pessoal do Poder Legislativo (art. 19 e 20) em percentual sobre a *Receita Corrente Líquida*.

Além disso, a LRF estabelece limites prudencial e de alerta os quais correspondem a 90% e 95% do limite máximo, que para o Poder Legislativo é de *6% da Receita Corrente Líquida*.

```{r}
df <- readxl::read_excel(ds_file, sheet = "PessoalLRF")
df$ano <- as.factor(format(df$data_base, format = "%Y"))
df$mes <- as.factor(format(df$data_base, format = "%b"))
df$data_base <- NULL
df <- select(df, ano, mes, indice, limite_maximo, limite_alerta, limite_prudencial)
df <- df[df$ano==ano_base,]
df$ano <- NULL
dfg <- df
df$indice <- percent(df$indice, big.mark = ".", decimal.mark = ",", accuracy = 0.01)
df$limite_maximo <- percent(df$limite_maximo, big.mark = ".", decimal.mark = ",")
df$limite_alerta <- percent(df$limite_alerta, big.mark = ".", decimal.mark = ",", accuracy = 0.01)
df$limite_prudencial <- percent(df$limite_prudencial, big.mark = ".", decimal.mark = ",", accuracy = 0.01)

```

```{r}
tbl = app.table.default(df, align=c("l", "r", "r", "r", "r"), caption = "Despesa Total com Pessoal (LRF)", col.names = c("Mês", "Índice", "Limite Legal", "Limite de Alerta", "Limite Prudencial"))
tbl
```

Os valores de RCL e Despesa Total com Pessoal utilizados para a apuração do índice são calculados conforme as disposições do TCE/RS.

```{r}
dfg$mes <- as.factor(dfg$mes)
g <- ggplot(dfg, aes(x = mes, group = 1)) +
  ggtitle("Despesa Total com Pessoal (LRF)") +
  geom_bar(aes(y = indice, fill = "Índice"), stat = "identity", position = "dodge", na.rm = TRUE) +
  geom_text(aes(y = indice, label = df$indice), vjust = -0.5, color = app.color.primary, na.rm = TRUE) +
  geom_line(aes(y = limite_maximo, linetype = "Limite"), na.rm = TRUE) +
  geom_line(aes(y = limite_alerta, linetype = "Alerta"), na.rm = TRUE) +
  geom_line(aes(y = limite_prudencial, linetype = "Prudencial"), na.rm = TRUE) +
  scale_y_continuous(labels = scales::percent_format(big.mark = ".", decimal.mark = ",")) +
  scale_x_discrete(limits = dfg$mes) +
  scale_fill_manual(values = app.color.primary) +
  scale_linetype_manual(values = c("dashed", "solid", "dotted"))
g <- app.plot.theming(g)
g
```

Até o mês corrente, observa-se uma tendência desse indicador se manter bastante abaixo do valor máximo permitido, isso se as variáveis que impactam na sua apuração se mantiverem nos níveis atuais.

## Limite de Suplementação Autorizado na Lei Orçamentária Anual

Tendo por base o § 8º do art. 165 da Constituição Federal, a Lei Orçamentária Anual traz em seu artigo 7º a autorização para abertura de créditos suplementares no Poder Legislativo, *limitado a 15% da dotação inicial* desse Poder.

Por sua vez, o art. 8º da Lei Orçamentária Anual elenca situações as quais os créditos abertos com base na autorização do art. 7º da LOA não oneram esse limite.

Desta forma, a cada resolução de abertura de crédito amparada nessa autorização, é feito o acompanhamento dos valores onerados do limite do Legislativo, o qual tem sua evolução apresentada na seguinte figura:

```{r}
df <- readxl::read_excel(ds_file, sheet = "LimiteSuplementacao")
df$ano <- as.factor(format(df$data_base, format = "%Y"))
df$mes <- as.factor(format(df$data_base, format = "%b"))
df$data_base <- NULL
df <- select(df, ano, mes, indice, limite, media)
df <- df[df$ano==ano_base,]
df$ano <- NULL
dfg <- df
df$indice <- percent(df$indice, big.mark = ".", decimal.mark = ",", accuracy = 0.01)
df$limite <- percent(df$limite, big.mark = ".", decimal.mark = ",")
df$media <- percent(df$media, big.mark = ".", decimal.mark = ",", accuracy = 0.01)

```

```{r}
tbl = app.table.default(df, align=c("l", "r", "r", "r"), caption = "Limite de Suplementação (LOA)", col.names = c("Mês", "Índice", "Limite", "Esperado"))
tbl
```

Cabe ressaltar que a partir do momento em que ocorrer a suplementação acima do limite permitido, isso representa o desatendimento a disposições legais e constitucionais, por isso é importantíssimo o acompanhamento constante desse indicador a fim de evitar eventual imputação de crime à Presidência da Câmara.

```{r}
dfg$mes <- as.factor(dfg$mes)
g <- ggplot(dfg, aes(x = mes, group = 1)) +
  ggtitle("Limite de Suplementação (LOA)") +
  geom_bar(aes(y = indice, fill = "Índice"), stat = "identity", position = "dodge", na.rm = TRUE) +
  geom_text(aes(y = indice, label = df$indice), vjust = -0.5, color = app.color.primary, na.rm = TRUE) +
  geom_line(aes(y = limite, linetype = "Limite"), na.rm = TRUE) +
  geom_line(aes(y = media, linetype = "Esperado"), na.rm = TRUE) +
  scale_y_continuous(labels = scales::percent_format(big.mark = ".", decimal.mark = ",")) +
  scale_x_discrete(limits = dfg$mes) +
  scale_fill_manual(values = app.color.primary) +
  scale_linetype_manual(values = c("dashed", "solid"))
g <- app.plot.theming(g)
g
```


Observa-se que o uso do limite se encontra em patamares confortáveis até o mês atual, sendo que se fosse estimado o comprometimento com base na média mensal[^1], ainda assim ele está abaixo do esperado.


***

# Indicadores Gerenciais

Nesta seção estão apresentados alguns indicadores de cunho gerencial com a finalidade de auxiliar a gestão da Câmara de Vereadores nas decisões que envolvam aspectos contábeis, orçamentários e financeiros.

## Resultado Orçamentário

O Poder Legislativo não possui arrecadação própria, sendo suas despesas arcadas mediante recursos repassados pelo Poder Executivo na forma de duodécimos. Isso não significa que o Poder Legislativo possui algum tipo de relação de dependência para com o Executivo, vez que é uma imposição constitucionalmente estabelecida essa sistemática de financiamento.

> Art. 168. Os recursos correspondentes às dotações orçamentárias, compreendidos os créditos suplementares e especiais, destinados aos órgãos dos Poderes Legislativo e Judiciário, do Ministério Público e da Defensoria Pública, ser-lhes-ão entregues até o dia 20 de cada mês, em duodécimos, na forma da lei complementar a que se refere o art. 165, § 9º.

Nessa sistemática, o valor a ser repassado em cada exercício financeiro corresponde à dotação atualizada da Câmara de Vereadores, *limitada a 7% da Receita Efetivamente Realizada no Ano Anterior*[^2]. Desta forma, e considerando a possibilidade de que as despesas efetivamente realizadas em cada ano sejam inferiores aos recursos efetivamente recebidos pelo Poder Legislativo, pode ocorrer uma situação de restarem ao final do ano recursos financeiros[^3]. 

Isto posto, o acompanhamento de eventual superávit estimado se constitui em importante indicador de gestão, sendo que esse resultado positivo entre duodécimo recebido e despesa executada, além de ser convertido ao final do exercício em recurso disponível para o Executivo, também pode ser utilizado durante o ano como fonte de recursos para abertura de créditos adicionais no Poder Executivo, mediante acordo entre os Poderes.


```{r}
df <- readxl::read_excel(ds_file, sheet = "ResultadoOrcamentario")
df$ano <- as.factor(format(df$data_base, format = "%Y"))
df$mes <- as.factor(format(df$data_base, format = "%b"))
df$data_base <- NULL
df <- select(df, ano, mes, valor)
pvt <- pivot_wider(df, names_from = ano, values_from = valor)
```

```{r}
cnames = append(list("Mês"), levels(unique(df$ano)))
tbl = app.table.default(pvt, align=c("l", "r", "r"), caption = "Resultado Orçamentário", col.names = cnames)
tbl
```

Para este indicador, é apresentado a evolução mensal do ano corrente e do ano anterior para fins de comparação.

O cálculo dos valores estimados é feito tendo por base a despesa com folha de pagamento e auxílio-alimentação, diárias, passagens e indenizações de viagem e inscrições em curso[^4],além de considerar as reduções orçamentárias que foram fonte de crédito adicional no Poder Executivo.
Para o mês de dezembro, em vez da estimativa, é utilizado o valor efetivamente apurado no ano.

```{r}
g <- ggplot(df) +
  ggtitle("Resultado Orçamentário") +
  geom_bar(aes(x = mes, y = valor, group = ano, fill = ano), stat = "identity", position = position_dodge(), na.rm = TRUE) +
  scale_y_continuous(labels = scales::number_format(big.mark = ".", decimal.mark = ",")) +
  scale_fill_manual(values = c(app.color.secondary, app.color.primary)) +
  scale_x_discrete(limits = levels(unique(df$mes)))
g <- app.plot.theming(g)
g
```
Até o período corrente, embora se observe uma grande redução da estimativa em relação aos valores estimados no ano anterior, ainda assim espera-se um resultado favorável significativo, indicando a possiblidade de desmobilização de recursos no Legislativo em favor do Executivo, seja no decorrer do ano, seja ao seu final.

## Saldo Financeiro Bruto e Líquido

Nesta subseção apresentamos a evolução dos saldos financeiros bruto e líquido das disponibilidades do Poder Legislativo.

```{r}
df <- readxl::read_excel(ds_file, sheet = "SaldoFinanceiro")
df$ano <- as.factor(format(df$data_base, format = "%Y"))
df$mes <- as.factor(format(df$data_base, format = "%b"))
df$data_base <- NULL
df <- select(df, ano, mes, bruto, disponivel)
df <- df[df$ano==ano_base,]
df$ano <- NULL
```

```{r}
tbl = app.table.default(df, align=c("l", "r", "r"), caption = "Disponibilidades Financeiras", col.names = c("Mês", "Saldo Bruto", "Saldo Disponível"))
tbl
```

O Saldo financeiro bruto representa o valor existente nas contas bancárias e aplicações financeiras do Poder Legislativo. O Saldo disponível, por sua vez, representa o saldo bruto deduzido dos empenhos liquidados e não liquidados a pagar e as retenções a recolher, bem como outros valores de terceiros[^5]. Em outras palavras, o Saldo disponível representa o valor financeiro disponível para empenho no encerramento do mês de referência.

```{r}
g <- ggplot(df, aes(x = mes, group = 1)) +
  ggtitle("Disponibilidades Financeiras") +
  geom_bar(aes(y = disponivel, fill = "Disponível"), stat = "identity", position = position_dodge(), na.rm = TRUE) +
  geom_line(aes(y = bruto, color = "Bruto"), na.rm = TRUE) +
  scale_y_continuous(labels = scales::number_format(big.mark = ".", decimal.mark = ",")) +
  scale_x_discrete(limits = df$mes) +
  scale_fill_manual(values = app.color.primary) + 
  scale_color_manual(values = app.color.primary)
g <- app.plot.theming(g)
g
```

Observa-se que o saldo bruto se mantém superior ao saldo disponível ou líquido e com uma diferença crescente, indicando uma situação de superávit de recursos, corroborando com a estimativa de resultado orçamentário apresentado alhures.

# Considerações Finais

Em termos de indicadores legais, notadamente limites impostos constitucional ou legalmente, até o mês de referência deste relatório, observa-se que **o Poder Legislativo atende a todos com margem confortável**.

Do ponto de vista gerencial, *ceteris paribus*[^6], **há indicativo de provável desfecho favorável** para a gestão financeira do Legislativo ao findar do ano.







Independência, RS, `r format(Sys.Date(), format = "%d de %B de %Y")`


***



[^1]: Limite dividido por 12 meses multiplicado pelo número de meses decorridos.

[^2]: Vide indicador de Gasto Total.

[^3]: Caso isso ocorra o § 2º do art. 168 da Constituição Federal determina a devolução ao Poder Executivo.

[^4]: Média mensal empenhada extrapolada anualmente.

[^5]: Tais como cauções e depósitos restituíveis.

[^6]: todo o resto constante